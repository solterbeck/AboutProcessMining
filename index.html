<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Process Mining Bibliography</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        header {
            background-color: #007bff;
            color: white;
            padding: 15px 20px;
        }
        header h1 {
            margin: 0;
            font-size: 1.5rem;
        }
        header nav {
            margin-top: 10px;
        }
        header nav a {
            color: white;
            margin-right: 15px;
            text-decoration: none;
            font-weight: bold;
        }
        header nav a:hover {
            text-decoration: underline;
        }
        .search-container {
            margin: 20px 0;
        }
        .filter-buttons {
            margin-bottom: 20px;
        }
        .filter-buttons button {
            margin-right: 10px;
        }
        .accordion-button:not(.collapsed) {
            color: #007bff;
            background-color: #e9ecef;
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header>
        <h1>All About Process Mining</h1>
        <nav>
            <a href="#bibliography">Bibliography</a>
            <a href="#imprint">Imprint</a>
        </nav>
    </header>

    <div class="container">
        <!-- Search and Filter Bar -->
        <div class="search-container">
            <input type="text" id="searchInput" class="form-control" placeholder="Search in Title, Author, Editor, Tags, and Abstract">
        </div>
        <div class="filter-buttons">
            <button class="btn btn-primary" id="filterAll">All</button>
            <button class="btn btn-outline-primary" id="filter2016">from 2016</button>
            <button class="btn btn-outline-primary" id="filter2000">from 2000</button>
            <button class="btn btn-outline-primary" id="filterBefore2000">before 2000</button>
            <button class="btn btn-outline-primary" id="filterNew">New Entries</button>
        </div>

        <!-- Bibliography List with Accordion -->
        <div class="accordion" id="bibliographyAccordion">
            <!-- Dynamic content will be rendered here -->
        </div>
    </div>

    <script>
        let data = null;       // Original data
        let filteredData = []; // Filtered data

        // Load the data dynamically
        $.getJSON('library_full_data.json', function(response) {
            data = response;
            filteredData = [...data]; // Initially, filteredData is the same as data
            renderBibliographyList(filteredData);
        });

        function renderBibliographyList(data) {
            const accordion = $("#bibliographyAccordion");
            accordion.empty();

            data.forEach((item, index) => {
                const entry = `
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="heading${index}">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse${index}" aria-expanded="false" aria-controls="collapse${index}">
                                ${item.Title || 'N/A'}
                            </button>
                        </h2>
                        <div id="collapse${index}" class="accordion-collapse collapse" aria-labelledby="heading${index}" data-bs-parent="#bibliographyAccordion">
                            <div class="accordion-body">
                                <p><strong>Author(s):</strong> ${item.Author || 'N/A'}</p>
                                <p><strong>Editor(s):</strong> ${item.Editor || 'N/A'}</p>
                                <p><strong>Item Type:</strong> ${item.ItemType || 'N/A'}</p>
                                <p><strong>Publication Title:</strong> ${item.PublicationTitle || 'N/A'}</p>
                                <p><strong>Publisher / Year / Pages / Language:</strong> 
                                    ${item.Publisher || '-'} / ${item.PublicationYear || '-'} / ${item.Pages || '-'} / ${item.Language || 'N/A'}
                                </p>
                                <p><strong>Tags:</strong> ${item.ManualTags || 'N/A'}</p>
                                <p><strong>Abstract:</strong> ${item.AbstractNote || 'N/A'}</p>
                                <p><strong>Source:</strong> 
                                    <a href="${item.Url || '#'}" target="_blank">Download or link to the source</a>
                                </p>
                            </div>
                        </div>
                    </div>
                `;
                accordion.append(entry);
            });
        }

        // Filter Buttons Functionality
        $("#filterAll").on("click", function () {
            filteredData = [...data];
            renderBibliographyList(filteredData);
        });

        $("#filter2016").on("click", function () {
            filteredData = data.filter(item => parseInt(item.PublicationYear) >= 2016);
            renderBibliographyList(filteredData);
        });

        $("#filter2000").on("click", function () {
            filteredData = data.filter(item => parseInt(item.PublicationYear) >= 2000);
            renderBibliographyList(filteredData);
        });

        $("#filterBefore2000").on("click", function () {
            filteredData = data.filter(item => parseInt(item.PublicationYear) < 2000);
            renderBibliographyList(filteredData);
        });

        $("#filterNew").on("click", function () {
            // Logic for new entries (if defined) goes here
        });

        // Search Functionality
        $("#searchInput").on("input", function () {
            const query = $(this).val().toLowerCase();
            filteredData = data.filter(item => 
                [
                    item.Title,
                    item.Author,
                    item.Editor,
                    item.ItemType,
                    item.PublicationTitle,
                    item.Publisher,
                    item.PublicationYear,
                    item.Pages,
                    item.Language,
                    item.ManualTags,
                    item.AbstractNote,
                    item.Url
                ]
                .some(val => (val || '').toString().toLowerCase().includes(query))
            );
            renderBibliographyList(filteredData);
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
</body>
</html>
